<dqm4hep>

    <archiver open="true" directory="/tmp" />

    <network>
        <runcontrol type="DimRunControlClient" name="SDHCALRunControl" />

        <eventcollector type="DimEventClient">
        	<parameter name="collectorName"> sdhcal_event_collector </parameter>
        	<parameter name="maxQueueSize"> 100 </parameter>
        	<parameter name="streamerName"> LCIOStreamer </parameter>
        </eventcollector>

        <monitorelementcollector name="sdhcal_me_collector"/>
    </network>

    <cycle type="TimerCycle" value="10" timeout="5" />

    <module type="HitAnalysisModule" name="HitAnalysisModule">
        <Trivent>
          <parameter name="RawCollectionNames"> DHCALRawHits </parameter>
          <parameter name="RecCollectionNames"> SDHCAL_HIT </parameter>
          <!-- Lookup in the same order as RawCollectionNames and RecCollectionNames -->
          <RawDataConverters>
            <converter plugin="SDHCALCaloHitConverter">
              <electronicsMapping plugin="SDHCALElectronicsMapping">
                <parameter name="CellReferencePosition"> 0 0 0 </parameter>
                <parameter name="CellSize0"> 10.408 </parameter>
                <parameter name="CellSize1"> 10.408 </parameter>
                <parameter name="ReadFromDB"> true </parameter>
                <parameter name="Host"> localhost </parameter>
                <parameter name="User"> root </parameter>
                <parameter name="Password"> plop </parameter>
                <parameter name="Database"> GEOMETRY </parameter>
                <parameter name="BeamTest"> SPS_10_2015 </parameter>
                <parameter name="GeometryFileName"> geometry_SPS_10_2015.xml </parameter>
              </electronicsMapping>

              <parameter name="AmplitudeBitRotation"> 3 </parameter>
              <parameter name="EncodeDifAsicChannel"> true </parameter>
              <parameter name="IJKEncoding"> I J K-1 </parameter>
              <parameter name="DifAsicChannelEncoding"> Dif_id Asic_id Chan_id </parameter>
              <parameter name="CellIDEncoderString"> I:7,J:7,K-1:6,Dif_id:8,Asic_id:8,Chan_id:6 </parameter>
            </converter>
          </RawDataConverters>

          <parameter name="TimeWindow"> 2 </parameter>
          <parameter name="MinPeakSize"> 10 </parameter>
          <parameter name="MinElements"> 10 </parameter>
          <parameter name="MaxElements"> 100000 </parameter>
        </Trivent>

        <parameter name="CellIDDecoderString"> I:7,J:7,K-1:6,Dif_id:8,Asic_id:8,Chan_id:6 </parameter>
        <parameter name="NActiveLayers">  48 </parameter>
        <parameter name="NStartLayerShift"> 0 </parameter>
        <parameter name="InputCollectionName"> SDHCAL_HIT </parameter>

        <!--  -->
        <parameter name="FirstLayerCut"> 1 </parameter>
         <!--  -->
        <parameter name="LastLayerCut"> 48 </parameter>
        <!-- Min number of Mip in the current layer for first/last layer estimation-->
        <parameter name="NMipInLayer"> 5 </parameter>
        <!-- Min number of Mip in the full detector to fill nHit histograms-->
        <parameter name="NMipMinimum"> 40 </parameter>

    <!-- ----------- Monitor elements ----------- -->
    <monitorElement ID="LayerNumberOfHits0"
      name="LayerNumberOfHits0" path="." type="TH1F" title="Number of hits0 in current layer"
      nBins="50" min="1" max="50"
      resetPolicy="EndOfRun"/>

    <monitorElement ID="LayerNumberOfHits1"
      name="LayerNumberOfHits1" path="." type="TH1F" title="Number of hits1 in current layer"
      nBins="50" min="1" max="50"
      resetPolicy="EndOfRun"/>

    <monitorElement ID="LayerNumberOfHits2"
      name="LayerNumberOfHits2" path="." type="TH1F" title="Number of hits2 in current layer"
      nBins="50" min="1" max="50"
      resetPolicy="EndOfRun"/>

    <monitorElement ID="LayerNumberOfHitsTotal"
      name="LayerNumberOfHitsTotal" path="." type="TH1F" title="Number of hits in current layer"
      nBins="100" min="1" max="100"
      resetPolicy="EndOfRun"/>

    <monitorElement ID="NumberOfHits0"
      name="NumberOfHits0" path="." type="TH1F" title="Total number of hits0 in detector"
      nBins="2000" min="1" max="2000"
      resetPolicy="EndOfRun"/>

    <monitorElement ID="NumberOfHits1"
      name="NumberOfHits1" path="." type="TH1F" title="Total number of hits1 in detector"
      nBins="1500" min="1" max="1500"
      resetPolicy="EndOfRun"/>

    <monitorElement ID="NumberOfHits2"
      name="NumberOfHits2" path="." type="TH1F" title="Total number of hits2 in detector"
      nBins="1000" min="1" max="1000"
      resetPolicy="EndOfRun"/>

    <monitorElement ID="NumberOfHitsTotal"
      name="NumberOfHitsTotal" path="." type="TH1F" title="Total number of hits in detector"
      nBins="1000" min="1" max="1000"
      resetPolicy="EndOfRun"/>

    </module>

</dqm4hep>
