<dqm4hep>

	<!-- 
	
	ppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppp
	ppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppp
	
	!!!!!!!!!!!!!!!!!!  PENSER A CHECKER LE MMAPING DE LELECTRONICS       !!!!!!!!!!!!!!!!!
	 Aparement ca marche pas le mapping que j'ai fait !!
	 VOIR AVEC ARNAUD POUR UN MAPPING COHERENT COMMUN !!!
	
	ppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppp
	ppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppp	
	
	 -->
    <archiver open="false" directory="/tmp" />
    
    <network>
        <runcontrol type="DimRunControlClient" name="SDHCALRunControl" />
        
        <eventcollector type="DimEventClient">
        	<parameter name="collectorName"> sdhcal_event_collector </parameter>
        	<parameter name="maxQueueSize"> 100 </parameter>
        	<parameter name="streamerName"> LCIOStreamer </parameter>
        </eventcollector>
        
        <monitorelementcollector name="sdhcal_me_collector"/>
    </network>
    
    <cycle type="TimerCycle" value="10" timeout="5" />

    <module type="AsicAnalysisModule" name="MyAsicAnalysisModule">

        <Trivent>
        	<parameter name="RawCollectionNames"> DHCALRawHits </parameter>
        	<parameter name="RecCollectionNames"> SDHCAL_HIT </parameter>
        	
        	<!-- Lookup in the same order as RawCollectionNames and RecCollectionNames -->
        	<RawDataConverters>
        		<converter plugin="SDHCALCaloHitConverter">
        			<electronicsMapping plugin="SDHCALElectronicsMapping">
        				<parameter name="CellReferencePosition"> 0 0 0 </parameter>
        				<parameter name="CellSize0"> 10.408f </parameter>
        				<parameter name="CellSize1"> 10.408f </parameter>
        				<parameter name="LayerThickness"> 26.73f </parameter>
        				<parameter name="GlobalDifShiftY"> 32 </parameter>
        				<parameter name="DifList">
	        				30 94 181     115 149 117     130 123 122     119 118 129     151 152 164     75 61 74     110 111 156 
							103 177 102     134 136 133     121 120 128     58 64 65     73 72 148     60 79 78 
							113 43 44     68 69 66     154 127 186     71 70 147     140 139 47     76 77 143 
							36 91 159     183 178 179     67 42 41     138 46 137     144 173 131     160 184 189 
							171 167 172     145 135 146     180 170 185     190 188 187     166 165 169     50 57 155 
							25 108 153     109 56 51     116 150 107     49 124 126     176 175 174     114 45 48 
							40 93 98     100 97 92     132 106 62     99 35 101     141 142 158     162 161 163 
							112 29 104     54 53 59     27 90 96     5 8 95     18 87 63 
        				</parameter>
        			</electronicsMapping>
        			<parameter name="CellIDEncoderString"> M:3,S-1:3,I:9,J:9,K-1:6 </parameter>
        		</converter>
        	</RawDataConverters>
        	<parameter name="TimeWindow"> 2 </parameter>
        	<parameter name="MinPeakSize"> 10 </parameter>
        	<parameter name="MinElements"> 10 </parameter>
        	<parameter name="MaxElements"> 100000 </parameter>
        </Trivent>
        
        <!-- 
        Old mapping : 
        		        			181 94 30  174 175 176  158 142 141  129 118 119  164 152 151   74 61 75 
							156 111 110  102 177 103   133 136 134   128 120 121   65 64 58   148 72 73 
							78 79 60   44 43 113   243 242 241    186 127 154   147 70 71    47 139 140 
							143 77 76    159 91 36    179 178 183   41 42 67   137 46 138   131 173 144 
							189 184 160   172 167 171   146 135 145   185 170 180   187 188 190   169 165 166 
							155 57 50   153 108 25    51 56 109    107 150 116   126 124 49   117 149 115 
							48 45 114    98 93 40    92 97 100   62 106 132   101 35 99   122 123 130 
							163 161 162   104 29 112   59 53 54   96 90 27   95 8 5   63 87 18 
        
         -->
                
        <parameter name="NActiveLayers">  48 </parameter>
        <parameter name="NStartLayerShift"> -1 </parameter>
        <parameter name="InputCollectionName"> SDHCAL_HIT </parameter>
        
        <!-- Needs to be duplicated unfortunately ... -->
        <parameter name="AsicTable">
			4 3 2 1 
			5 6 7 8 
			12 11 10 9 
			13 14 15 16 
			20 19 18 17 
			21 22 23 24 
			28 27 26 25 
			29 30 31 32 
			36 35 34 33 
			37 38 39 40 
			44 43 42 41 
			45 46 47 48
        </parameter>
        <parameter name="DifList"> 
	        181 94 30     117 149 115     122 123 130     129 118 119     164 152 151     74 61 75     156 111 110 
			102 177 103     133 136 134     128 120 121     65 64 58     148 72 73     78 79 60 
			44 43 113     66 69 68     186 127 154     147 70 71     47 139 140     143 77 76 
			159 91 36     179 178 183     41 42 67     137 46 138     131 173 144     189 184 160 
			172 167 171     146 135 145     185 170 180     187 188 190     169 165 166     155 57 50 
			153 108 25     51 56 109     107 150 116     126 124 49     174 175 176     48 45 114 
			98 93 40     92 97 100     62 106 132     101 35 99     158 142 141     163 161 162 
			104 29 112     59 53 54     96 90 27     95 8 5     63 87 18
        </parameter>
        
        <!-- 
        Mapping provided by Arnaud : 
        			181 94 30  174 175 176  158 142 141  129 118 119  164 152 151   74 61 75 
			156 111 110  102 177 103   133 136 134   128 120 121   65 64 58   148 72 73 
			78 79 60   44 43 113   243 242 241    186 127 154   147 70 71    47 139 140 
			143 77 76    159 91 36    179 178 183   41 42 67   137 46 138   131 173 144 
			189 184 160   172 167 171   146 135 145   185 170 180   187 188 190   169 165 166 
			155 57 50   153 108 25    51 56 109    107 150 116   126 124 49   117 149 115 
			48 45 114    98 93 40    92 97 100   62 106 132   101 35 99   122 123 130 
			163 161 162   104 29 112   59 53 54   96 90 27   95 8 5   63 87 18 
         -->
        
        <!-- ----------- Monitor elements ----------- -->
		<monitorElement ID="EfficiencyMap"
			name="EfficiencyMap" path="/Layers/EfficiencyMaps/Thr1" type="TH2F" title="Efficiency map (thr 1)" 
			nBinsX="12" minX="0" maxX="12" nBinsY="12" minY="0" maxY="12"
			drawOption="colz" resetPolicy="EndOfRun"/>
			
		<monitorElement ID="Efficiency2Map"
			name="EfficiencyMap" path="/Layers/EfficiencyMaps/Thr2" type="TH2F" title="Efficiency map (thr 2)" 
			nBinsX="12" minX="0" maxX="12" nBinsY="12" minY="0" maxY="12"
			drawOption="colz" resetPolicy="EndOfRun"/>
			
		<monitorElement ID="Efficiency3Map"
			name="EfficiencyMap" path="/Layers/EfficiencyMaps/Thr3" type="TH2F" title="Efficiency map (thr 3)" 
			nBinsX="12" minX="0" maxX="12" nBinsY="12" minY="0" maxY="12"
			drawOption="colz" resetPolicy="EndOfRun"/>
			
		<monitorElement ID="MultiplicityMap"
			name="MultiplicityMap" path="/Layers/MultiplicityMaps" type="TH2F" title="Multiplicity map" 
			nBinsX="12" minX="0" maxX="12" nBinsY="12" minY="0" maxY="12"
			drawOption="colz" resetPolicy="EndOfRun"/>
			
			
		<monitorElement ID="LayerEfficiency"
			name="LayerEfficiency" path="/Global/Thr1" type="user" ROOTClass="TGraph" 
			title="Layer efficiencies" drawOption="ap" resetPolicy="EndOfRun"/>
			
		<monitorElement ID="LayerEfficiency2"
			name="LayerEfficiency" path="/Global/Thr2" type="user" ROOTClass="TGraph" 
			title="Layer efficiencies (thr 2)" drawOption="ap" resetPolicy="EndOfRun"/>
			
		<monitorElement ID="LayerEfficiency3"
			name="LayerEfficiency" path="/Global/Thr3" type="user" ROOTClass="TGraph" 
			title="Layer efficiencies (thr 3)" drawOption="ap" resetPolicy="EndOfRun"/>
			
		<monitorElement ID="LayerMultiplicity"
			name="LayerMultiplicity" path="/Global/Multiplicity" type="user" ROOTClass="TGraph" 
			title="Layer multiplicities" drawOption="ap" resetPolicy="EndOfRun"/>
			
			
		<monitorElement ID="AsicEfficiency"
			name="AsicEfficiency" path="/Global/Thr1" type="TH1F" title="Asic efficiencies" 
			nBins="101" min="0" max="1"
			resetPolicy="EndOfRun"/>
			
		<monitorElement ID="AsicEfficiency2"
			name="AsicEfficiency" path="/Global/Thr2" type="TH1F" title="Asic efficiencies (thr 2)" 
			nBins="101" min="0" max="1"
			resetPolicy="EndOfRun"/>
			
		<monitorElement ID="AsicEfficiency3"
			name="AsicEfficiency" path="/Global/Thr3" type="TH1F" title="Asic efficiencies (thr 3)" 
			nBins="101" min="0" max="1"
			resetPolicy="EndOfRun"/>
			
		<monitorElement ID="AsicMultiplicity"
			name="AsicMultiplicity" path="/Global/Multiplicity" type="TH1F" title="Asic multiplicities" 
			nBins="101" min="0" max="10"
			resetPolicy="EndOfRun"/>
			
			
		<monitorElement ID="StackedEfficiencyMap"
			name="StackedEfficiencyMap" path="/Global/Thr1" type="TH2F" title="Stacked efficiency map" 
			nBinsX="12" minX="0" maxX="12" nBinsY="12" minY="0" maxY="12"  
			drawOption="colz" resetPolicy="EndOfRun"/>
			
		<monitorElement ID="StackedEfficiency2Map"
			name="StackedEfficiencyMap" path="/Global/Thr2" type="TH2F" title="Stacked efficiency map (thr 2)" 
			nBinsX="12" minX="0" maxX="12" nBinsY="12" minY="0" maxY="12"  
			drawOption="colz" resetPolicy="EndOfRun"/>
			
		<monitorElement ID="StackedEfficiency3Map"
			name="StackedEfficiencyMap" path="/Global/Thr3" type="TH2F" title="Stacked efficiency map (thr 3)" 
			nBinsX="12" minX="0" maxX="12" nBinsY="12" minY="0" maxY="12"  
			drawOption="colz" resetPolicy="EndOfRun"/>
			
		<monitorElement ID="StackedMultiplicityMap"
			name="StackedMultiplicityMap" path="/Global/Multiplicity" type="TH2F" title="Stacked multiplicity map" 
			nBinsX="12" minX="0" maxX="12" nBinsY="12" minY="0" maxY="12"
			drawOption="colz" resetPolicy="EndOfRun"/>
			
			
		<monitorElement ID="GlobalEfficiency"
			name="GlobalEfficiency" path="/Global/Thr1" type="float" title="Global efficiency" 
			value="0" resetPolicy="EndOfRun"/>
			
		<monitorElement ID="GlobalEfficiency2"
			name="GlobalEfficiency" path="/Global/Thr2" type="float" title="Global efficiency (thr 2)" 
			value="0" resetPolicy="EndOfRun"/>
			
		<monitorElement ID="GlobalEfficiency3"
			name="GlobalEfficiency" path="/Global/Thr3" type="float" title="Global efficiency (thr 3)" 
			value="0" resetPolicy="EndOfRun"/>
			
		<monitorElement ID="GlobalMultiplicity"
			name="GlobalMultiplicity" path="/Global/Multiplicity" type="float" title="Global multiplicities" 
			value="0" resetPolicy="EndOfRun"/>
			
			
		<monitorElement ID="NTracksPerAsic"
			name="NTracksPerAsic" path="/Global" type="TH1F" title="Number of rec tracks per asic" 
			nBins="10001" min="0" max="10000"
			resetPolicy="EndOfRun"/>
    </module>

</dqm4hep>
